import{a1 as fe,r as s,d as ye,j as n,M as Te,T as je,U as C}from"./index-DTwxqu1t.js";import{a as v,b as te,h as ne}from"./apiClient-BdZFA0eS.js";import{T as Se,c as b,b as d}from"./Constants-Aq5C2dlb.js";import{R as Ce}from"./index-Ds6NLlP0.js";import{T as g}from"./TextField-BrIKXlBB.js";import{S as I}from"./Select-Cg_d5LfK.js";import{M as c}from"./MenuItem-C1BekbPD.js";import{B as F}from"./Button-DsFXmZBL.js";import"./InputLabel-B5_iZlRn.js";const Pe=()=>{let{id:m,compid:l}=fe();const[i,ie]=s.useState(null),[N,se]=s.useState(""),[x,re]=s.useState([]),[f,D]=s.useState(""),[E,y]=s.useState(""),[oe,k]=s.useState(null),[w,L]=s.useState(0),[T,le]=s.useState([]),[R,U]=s.useState(""),[P,W]=s.useState(""),[M,_]=s.useState(""),[B,H]=s.useState(null),[j,ae]=s.useState([]),[O,S]=s.useState(l),h=ye();function de(e){const t=new DOMParser().parseFromString(e,"text/html"),a=document.createTreeWalker(t.body,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,null,!1);let r="";for(;a.nextNode();){const o=a.currentNode;o.nodeType===Node.TEXT_NODE?r+=o.nodeValue:o.nodeType===Node.ELEMENT_NODE&&(o.tagName==="BR"||o.tagName==="P"||o.tagName==="DIV"||o.tagName==="UL"||o.tagNameg=="LI")&&(r+=`
`)}return r=r.replace(/^\n+|\n+$/g,""),r=r.replace(/\n{2,}/g,`
`),r}const ce=async()=>{var r,o,A,V,X,Y,$,q,Q,J,Z,ee;const e=d+"/KioskServiceDetail/get-service-detail-by-id/"+m,t=await v(e);ie(t);const a=Se+l+"/"+((A=(o=(r=t==null?void 0:t.blobLink)==null?void 0:r.split("/"))==null?void 0:o.pop())==null?void 0:A.toString());if(se(a),D(t==null?void 0:t.htmlTranscript),S(t==null?void 0:t.companyId),L(t==null?void 0:t.serviceId),_(t==null?void 0:t.title),U(t==null?void 0:t.timeForService),W(t==null?void 0:t.chargeForService),H(t==null?void 0:t.branchId),t!=null&&t.imageLink){const p=(Y=(X=(V=t==null?void 0:t.imageLink)==null?void 0:V.split("/"))==null?void 0:X.pop())==null?void 0:Y.toString(),u=b+l+"/"+p;y(u)}else if(t!=null&&t.docLink){const p=(Q=(q=($=t==null?void 0:t.docLink)==null?void 0:$.split("/"))==null?void 0:q.pop())==null?void 0:Q.toString(),u=b+l+"/"+p;y(u)}else{const p=(ee=(Z=(J=t==null?void 0:t.blobLink)==null?void 0:J.split("/"))==null?void 0:Z.pop())==null?void 0:ee.toString(),u=b+l+"/"+p;y(u)}},me=async()=>{const e=d+"/KioskService/get-all-company-department/"+l,t=await v(e);re(t)},G="use-uuid-if-multiple-on-page";s.useEffect(()=>{const e=document.querySelector(`#${G}`);e&&e.load()}),s.useEffect(()=>{me(),ce()},[m,N,l]);const pe=async()=>{const e=d+"/Company/get-companies/",t=await v(e);le(t),S(l),ue(l)},ue=async e=>{const t=d+"/Branch/get-all-branches-for-company/"+e;let a=await v(t);ae(a)};s.useEffect(()=>{pe()},[]);const K={PaperProps:{style:{maxHeight:48*4.5+8,width:250}}},ge=async()=>{let e=new FormData;if(e.append("id",m),e.append("title",M),e.append("companyID",O),e.append("serviceId",w),e.append("timeForService",R),e.append("chargeForService",P),e.append("branchId",B),!(i!=null&&i.isTTSContent)){const r=d+"/KioskServiceDetail/save-service-detail";await te(r,e),h(-1);return}let t=de(f);e.append("transcript",t),e.append("HTMLTranscript",f),e.append("supportingFile",oe);const a=d+"/KioskServiceDetail/save-tts-service-detail";await te(a,e),h(-1)},he=async()=>{var e=confirm("are you sure you want to permanently delete this record");if(!e)return;const t=d+"/KioskServiceDetail/delete-service-detail/"+m;await ne(t,{}),h(-1)},[ve,z]=s.useState(!1),xe=async()=>{const e=d+"/KioskServiceDetail/convert-tts-service-detail/"+m;var t=confirm("are you sure you want to use this service");t&&(z(!0),await ne(e,{}),z(!1),h(-1))};return n.jsxs(Te,{title:"Editing Service Detail",children:[n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Title"}),n.jsx(g,{id:"outlined-basic",value:M,onChange:e=>{var t;_((t=e==null?void 0:e.target)==null?void 0:t.value)},variant:"outlined",autoComplete:"off",fullWidth:!0})]}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Is Text To Speech Content:Â  "}),(i==null?void 0:i.isTTSContent)&&n.jsx("span",{style:{fontWeight:"bold",color:"green"},children:"Yes"}),!(i!=null&&i.isTTSContent)&&n.jsx("span",{style:{fontWeight:"bold",color:"red"},children:"No"})]}),(i==null?void 0:i.isTTSContent)&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginTop:"0.9rem"},children:n.jsx("span",{children:"Transcript"})}),n.jsx(Ce,{value:f,onChange:D})]}),i!=null&&i.isTTSContent?n.jsx(n.Fragment,{children:n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{style:{marginRight:"1rem"},children:"Chosen Supporting File"}),n.jsx("span",{style:{width:"2rem"},children:"      "}),n.jsx("a",{href:E,target:"_blank",children:"Uploaded File"}),n.jsx(g,{id:"outlined-basic",inputProps:{accept:".docx,.doc,.pdf"},variant:"outlined",type:"file",autoComplete:"off",fullWidth:!0,onChange:e=>{var t;return k((t=e==null?void 0:e.target)==null?void 0:t.files[0])}})]})}):n.jsx(n.Fragment,{children:n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{style:{marginRight:"1rem"},children:"Chosen File"}),n.jsx("span",{style:{width:"2rem"},children:"      "}),n.jsx("a",{href:E,target:"_blank",children:"Uploaded File"}),n.jsx(g,{id:"outlined-basic",variant:"outlined",type:"file",autoComplete:"off",fullWidth:!0,onChange:e=>{var t;return k((t=e==null?void 0:e.target)==null?void 0:t.files[0])}})]})}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Time For Service"}),n.jsx(g,{variant:"outlined",multiline:!0,value:R,onChange:e=>{var t;U((t=e==null?void 0:e.target)==null?void 0:t.value)},fullWidth:!0})]}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Charge For Service"}),n.jsx(g,{variant:"outlined",multiline:!0,value:P,onChange:e=>{var t;W((t=e==null?void 0:e.target)==null?void 0:t.value)},fullWidth:!0})]}),(i==null?void 0:i.isTTSContent)&&n.jsxs(n.Fragment,{children:[n.jsx(je,{variant:"body1",style:{marginTop:"0.9rem"},children:"Generated Speech :"}),n.jsxs("audio",{id:G,controls:!0,children:[n.jsx("source",{src:N,type:"audio/mpeg"}),"Your browser does not support the audio element."]},123)]}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:0,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Company"}),n.jsxs(I,{disabled:!0,labelId:"demo-select-small-label",id:"demo-select-small",value:Number(O),width:"300px",placeholder:"Choose your Company",MenuProps:K,onChange:e=>{var t;S(Number((t=e==null?void 0:e.target)==null?void 0:t.value))},children:[n.jsx(c,{value:"",children:n.jsx("em",{children:"None"})}),T==null?void 0:T.map(e=>n.jsx(c,{value:e==null?void 0:e.id,children:e==null?void 0:e.name},e==null?void 0:e.id))]})]})})}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:0,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Service Branch"}),n.jsxs(I,{labelId:"demo-select-small-label",id:"demo-select-small",value:Number(B),width:"300px",placeholder:"Choose your Company",MenuProps:K,onChange:e=>{var t;return H((t=e==null?void 0:e.target)==null?void 0:t.value)},children:[n.jsx(c,{value:"",children:n.jsx("em",{children:"None"})}),j==null?void 0:j.map(e=>n.jsx(c,{value:e==null?void 0:e.id,children:e==null?void 0:e.title},e==null?void 0:e.id))]})]})})}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:1,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Service Department"}),n.jsxs(I,{labelId:"demo-select-small-label",id:"demo-select-small",value:Number(w),width:"300px",onChange:e=>{var t;L((t=e==null?void 0:e.target)==null?void 0:t.value)},children:[n.jsx(c,{value:"",children:n.jsx("em",{children:"None"})}),x==null?void 0:x.map(e=>n.jsx(c,{value:e==null?void 0:e.id,children:e==null?void 0:e.departmentName},e==null?void 0:e.id))]})]})})}),ve?n.jsx("div",{children:n.jsx("p",{style:{color:"gray",fontWeight:"bold",fontSize:"1.1rem"},children:"Converting Text To Speech ...."})}):n.jsxs("div",{style:{marginTop:"1.2rem"},children:[n.jsx(F,{variant:"contained",onClick:()=>ge(),children:"Save Changes"}),(i==null?void 0:i.isTTSContent)&&n.jsx(F,{color:"info",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>xe(),children:"Convert TTS"}),n.jsx(F,{color:"error",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>{he()},children:"Delete"})]})]})};export{Pe as default};
