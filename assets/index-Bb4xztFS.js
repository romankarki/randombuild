import{d as F,a1 as O,r as a,j as s,M as k,U as _}from"./index-BRiPDprX.js";import{h as j,a as E}from"./apiClient-BdZFA0eS.js";import{b as m}from"./Constants-C3A6Gqx3.js";import"./index.esm-D14sf4G8.js";import{T as C}from"./TextField-B9RgCfUw.js";import{S as A}from"./Select-B1tC3DLq.js";import{M as y}from"./MenuItem-B0v1FVPj.js";import{B as N}from"./Button-CgWm9gs8.js";import"./InputLabel-BGqQE_mf.js";const X=()=>{const c=F();let{id:o}=O();a.useState(!1);const[l,f]=a.useState(""),[G,w]=a.useState(""),[H,S]=a.useState(""),[p,x]=a.useState(""),[d,g]=a.useState(0),[u,I]=a.useState([]);a.useState([]);const T=async()=>{if(!v())return;const e={id:Number(o),details:l,companyId:d,updatedExpiryDate:p,noOfDaysForExpiry:2,links:""},n=m+"/NewsAndNotice/save-flash-news";await j(n,e),c(-1)},h=async()=>{if(!v())return;const e={id:o,details:l,companyId:d,updatedExpiryDate:p,isDeleted:!0,noOfDaysForExpiry:2,links:""};var n=confirm("are you sure you want to permanently delete this record");if(!n)return;const r=m+"/NewsAndNotice/save-flash-news";await j(r,e),c(-1)},v=()=>{let t=[];d||t.push("Company is mandatory"),l||t.push("Details is require");let e=t.join(`
`);return t.length>0?(alert(e),!1):!0},b=async()=>{const t=m+"/Company/get-companies/",e=await E(t);I(e)};a.useEffect(()=>{b()},[]);const P=async()=>{var D;const t=m+"/NewsAndNotice/get-flash-news-by-id/"+o;let e=await E(t);f(e==null?void 0:e.content),S(e==null?void 0:e.expiryDate);let n=(D=e==null?void 0:e.expiryDate)==null?void 0:D.split(" ")[0],r=new Date(n).toISOString().split("T")[0];console.log("date after parsing",r),console.log("result format of expiry date",r),x(r),w(e==null?void 0:e.links),g(e==null?void 0:e.companyId)};a.useEffect(()=>{P()},[o]);const M={PaperProps:{style:{maxHeight:48*4.5+8,width:250}}},i=JSON.parse(sessionStorage.getItem("user"));return s.jsxs(k,{title:"Editing Flash News",children:[s.jsxs("div",{style:{marginTop:"0.9rem"},children:[s.jsx("span",{children:"Details"}),s.jsx(C,{id:"outlined-basic",value:l,variant:"outlined",autoComplete:"off",fullWidth:!0,onChange:t=>{var e;return f((e=t==null?void 0:t.target)==null?void 0:e.value)}})]}),s.jsxs("div",{style:{marginTop:"0.9rem"},children:[s.jsx("span",{children:"Expiry Date"}),s.jsx(C,{type:"date",id:"outlined-basic",variant:"outlined",value:p,autoComplete:"off",fullWidth:!0,onChange:t=>{var e;return x((e=t==null?void 0:t.target)==null?void 0:e.value)}})]}),s.jsx("div",{style:{marginTop:"0rem"},children:s.jsx(_,{sx:{m:0,minWidth:120},size:"small",children:s.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[s.jsx("p",{style:{marginRight:"2rem"},children:"Parent Company"}),s.jsxs(A,{labelId:"demo-select-small-label",id:"demo-select-small",value:Number(d),width:"300px",placeholder:"Choose your Company",MenuProps:M,onChange:t=>{var e;g(Number((e=t==null?void 0:t.target)==null?void 0:e.value))},children:[s.jsx(y,{value:"",children:s.jsx("em",{children:"None"})}),u==null?void 0:u.map(t=>(i==null?void 0:i.role)==="superadmin"?s.jsx(y,{value:t==null?void 0:t.id,children:t==null?void 0:t.name},t==null?void 0:t.id):(t==null?void 0:t.id)===(i==null?void 0:i.companyId)?s.jsx(y,{value:t==null?void 0:t.id,children:t==null?void 0:t.name},t==null?void 0:t.id):null)]})]})})}),s.jsxs("div",{style:{marginTop:"0.9rem"},children:[s.jsx(N,{variant:"contained",onClick:()=>T(),children:"Save Changes"}),s.jsx(N,{color:"error",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>{h()},children:"Delete"})]})]})};export{X as default};
