import{Z as me,r,d as pe,j as t,M as ue,T as ve,W as Y}from"./index-ZDD_OGMu.js";import{a as F,b as he,h as N}from"./apiClient-OPmdi5JO.js";import{T as ge,c as D,b as a}from"./Constants-Ctlr_h4s.js";import{R as xe}from"./index-DcBUVqE4.js";import{T as c}from"./TextField-D33VU5iS.js";import{S as $}from"./Select-CIif3pin.js";import{M as h}from"./MenuItem-C9iTeXka.js";import{B as E}from"./Button-BJQZiDvD.js";import"./InputLabel-Dw3maVgU.js";const ke=()=>{let{id:d,compid:l}=me();const[n,q]=r.useState(null),[k,Q]=r.useState(""),[g,Z]=r.useState([]),[x,L]=r.useState(""),[J,T]=r.useState(""),[Te,ee]=r.useState(null),[f,w]=r.useState(0),[S,te]=r.useState([]),[j,P]=r.useState(""),[y,W]=r.useState(""),[C,R]=r.useState(""),[b,I]=r.useState(l),v=pe();function ie(i){const e=new DOMParser().parseFromString(i,"text/html"),m=document.createTreeWalker(e.body,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,null,!1);let s="";for(;m.nextNode();){const o=m.currentNode;o.nodeType===Node.TEXT_NODE?s+=o.nodeValue:o.nodeType===Node.ELEMENT_NODE&&(o.tagName==="BR"||o.tagName==="P"||o.tagName==="DIV"||o.tagName==="UL"||o.tagNameg=="LI")&&(s+=`
`)}return s=s.replace(/^\n+|\n+$/g,""),s=s.replace(/\n{2,}/g,`
`),s}const ne=async()=>{var s,o,_,H,O,G,B,K,z,A,V,X;const i=a+"/KioskServiceDetail/get-service-detail-by-id/"+d,e=await F(i);q(e);const m=ge+l+"/"+((_=(o=(s=e==null?void 0:e.blobLink)==null?void 0:s.split("\\"))==null?void 0:o.pop())==null?void 0:_.toString());if(Q(m),L(e==null?void 0:e.htmlTranscript),I(e==null?void 0:e.companyId),w(e==null?void 0:e.serviceId),R(e==null?void 0:e.title),P(e==null?void 0:e.timeForService),W(e==null?void 0:e.chargeForService),e!=null&&e.imageLink){const p=(G=(O=(H=e==null?void 0:e.imageLink)==null?void 0:H.split("\\"))==null?void 0:O.pop())==null?void 0:G.toString(),u=D+l+"/"+p;T(u)}else if(e!=null&&e.docLink){const p=(z=(K=(B=e==null?void 0:e.docLink)==null?void 0:B.split("\\"))==null?void 0:K.pop())==null?void 0:z.toString(),u=D+l+"/"+p;T(u)}else{const p=(X=(V=(A=e==null?void 0:e.blobLink)==null?void 0:A.split("\\"))==null?void 0:V.pop())==null?void 0:X.toString(),u=D+l+"/"+p;T(u)}},se=async()=>{const i=a+"/KioskService/get-all-company-services/1",e=await F(i);Z(e)},M="use-uuid-if-multiple-on-page";r.useEffect(()=>{const i=document.querySelector(`#${M}`);i&&i.load()}),r.useEffect(()=>{se(),ne()},[d,k,l]);const re=async()=>{const i=a+"/Company/get-companies/",e=await F(i);te(e),I(l)};r.useEffect(()=>{re()},[]);const oe={PaperProps:{style:{maxHeight:48*4.5+8,width:250}}},le=async()=>{if(!(n!=null&&n.isTTSContent)){let s=new FormData;s.append("id",d),s.append("title",C),s.append("companyID",b),s.append("serviceId",f),s.append("timeForService",j),s.append("chargeForService",y);const o=a+"/KioskServiceDetail/save-service-detail";await he(o,s),v(-1);return}let i=ie(x),e={id:d,title:C,HTMLTranscript:x,transcript:i,companyId:b,serviceId:f,timeForService:j,chargeForService:y};const m=a+"/KioskServiceDetail/save-tts-service-detail";await N(m,e),v(-1)},ae=async()=>{var i=confirm("are you sure you want to permanently delete this record");if(!i)return;const e=a+"/KioskServiceDetail/delete-service-detail/"+d;await N(e,{}),v(-1)},[ce,U]=r.useState(!1),de=async()=>{const i=a+"/KioskServiceDetail/convert-tts-service-detail/"+d;var e=confirm("are you sure you want to use this service");e&&(U(!0),await N(i,{}),U(!1),v(-1))};return t.jsxs(ue,{title:"Editing Service Detail",children:[t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Title"}),t.jsx(c,{id:"outlined-basic",value:C,onChange:i=>{var e;R((e=i==null?void 0:i.target)==null?void 0:e.value)},variant:"outlined",autoComplete:"off",fullWidth:!0})]}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Is Text To Speech Content:Â  "}),(n==null?void 0:n.isTTSContent)&&t.jsx("span",{style:{fontWeight:"bold",color:"green"},children:"Yes"}),!(n!=null&&n.isTTSContent)&&t.jsx("span",{style:{fontWeight:"bold",color:"red"},children:"No"})]}),(n==null?void 0:n.isTTSContent)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{marginTop:"0.9rem"},children:t.jsx("span",{children:"Transcript"})}),t.jsx(xe,{value:x,onChange:L})]}),!(n!=null&&n.isTTSContent)&&t.jsx(t.Fragment,{children:t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{style:{marginRight:"1rem"},children:"Chosen File"}),t.jsx("span",{style:{width:"2rem"},children:"      "}),t.jsx("a",{href:J,target:"_blank",children:"Uploaded File"}),t.jsx(c,{id:"outlined-basic",variant:"outlined",type:"file",autoComplete:"off",fullWidth:!0,onChange:i=>{var e;return ee((e=i==null?void 0:i.target)==null?void 0:e.files[0])}})]})}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Time For Service"}),t.jsx(c,{variant:"outlined",multiline:!0,value:j,onChange:i=>{var e;P((e=i==null?void 0:i.target)==null?void 0:e.value)},fullWidth:!0})]}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Charge For Service"}),t.jsx(c,{variant:"outlined",multiline:!0,value:y,onChange:i=>{var e;W((e=i==null?void 0:i.target)==null?void 0:e.value)},fullWidth:!0})]}),(n==null?void 0:n.isTTSContent)&&t.jsxs(t.Fragment,{children:[t.jsx(ve,{variant:"body1",style:{marginTop:"0.9rem"},children:"Generated Speech :"}),t.jsxs("audio",{id:M,controls:!0,children:[t.jsx("source",{src:k,type:"audio/mpeg"}),"Your browser does not support the audio element."]},123)]}),t.jsx("div",{style:{marginTop:"0rem"},children:t.jsx(Y,{sx:{m:0,minWidth:120},size:"small",children:t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[t.jsx("p",{style:{marginRight:"2rem"},children:"Company"}),t.jsxs($,{disabled:!0,labelId:"demo-select-small-label",id:"demo-select-small",value:Number(b),width:"300px",placeholder:"Choose your Company",MenuProps:oe,onChange:i=>{var e;I(Number((e=i==null?void 0:i.target)==null?void 0:e.value))},children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),S==null?void 0:S.map(i=>t.jsx(h,{value:i==null?void 0:i.id,children:i==null?void 0:i.name},i==null?void 0:i.id))]})]})})}),t.jsx("div",{style:{marginTop:"0rem"},children:t.jsx(Y,{sx:{m:1,minWidth:120},size:"small",children:t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[t.jsx("p",{style:{marginRight:"2rem"},children:"Service"}),t.jsxs($,{disabled:!0,labelId:"demo-select-small-label",id:"demo-select-small",value:Number(f),width:"300px",onChange:i=>{var e;w((e=i==null?void 0:i.target)==null?void 0:e.value)},children:[t.jsx(h,{value:"",children:t.jsx("em",{children:"None"})}),g==null?void 0:g.map(i=>t.jsx(h,{value:i==null?void 0:i.id,children:i==null?void 0:i.title},i==null?void 0:i.id))]})]})})}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Grievance Person"}),t.jsx(c,{id:"outlined-basic",value:n==null?void 0:n.grievancePerson,disabled:!0,variant:"outlined",autoComplete:"off",fullWidth:!0})]}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Responsible Person"}),t.jsx(c,{id:"outlined-basic",value:n==null?void 0:n.responsiblePerson,disabled:!0,fullWidth:!0})]}),t.jsxs("div",{style:{marginTop:"0.9rem"},children:[t.jsx("span",{children:"Branch Name"}),t.jsx(c,{id:"outlined-basic",value:n==null?void 0:n.branchName,disabled:!0,variant:"outlined",autoComplete:"off",fullWidth:!0})]}),ce?t.jsx("div",{children:t.jsx("p",{style:{color:"gray",fontWeight:"bold",fontSize:"1.1rem"},children:"Converting Text To Speech ...."})}):t.jsxs("div",{style:{marginTop:"1.2rem"},children:[t.jsx(E,{variant:"contained",onClick:()=>le(),children:"Save Changes"}),(n==null?void 0:n.isTTSContent)&&t.jsx(E,{color:"info",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>de(),children:"Convert TTS"}),t.jsx(E,{color:"error",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>{ae()},children:"Delete"})]})]})};export{ke as default};
