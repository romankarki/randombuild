import{Z as Se,r as s,d as Te,j as n,M as Ce,T as be,F as C}from"./index-DRQ6_V5g.js";import{a as v,b as ie,h as se}from"./apiClient-BdZFA0eS.js";import{T as Ie,b as c,c as b}from"./Constants-CKiQFZHc.js";import{R as Fe}from"./index-Dd5SIQRx.js";import{T as h}from"./TextField-BJxCmcBS.js";import{S as Ne}from"./Switch-BZZrRvO0.js";import{S as I}from"./Select-DzrpZOsU.js";import{M as d}from"./MenuItem-CAejK8zD.js";import{B as F}from"./Button-DqR8CO8c.js";import"./InputLabel-BfdBC-nT.js";import"./SwitchBase-UwyU8-RP.js";const Ae=()=>{let{id:m,compid:l}=Se();const[i,re]=s.useState(null),[N,oe]=s.useState(""),[x,le]=s.useState([]),[f,D]=s.useState(""),[k,j]=s.useState(""),[ae,E]=s.useState(null),[w,L]=s.useState(0),[y,ce]=s.useState([]),[P,R]=s.useState(""),[U,W]=s.useState(""),[M,_]=s.useState(""),[B,H]=s.useState(null),[S,de]=s.useState([]),[A,O]=s.useState(!0),[G,T]=s.useState(l),g=Te();function me(e){const t=new DOMParser().parseFromString(e,"text/html"),a=document.createTreeWalker(t.body,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,null,!1);let r="";for(;a.nextNode();){const o=a.currentNode;o.nodeType===Node.TEXT_NODE?r+=o.nodeValue:o.nodeType===Node.ELEMENT_NODE&&(o.tagName==="BR"||o.tagName==="P"||o.tagName==="DIV"||o.tagName==="UL"||o.tagNameg=="LI")&&(r+=`
`)}return r=r.replace(/^\n+|\n+$/g,""),r=r.replace(/\n{2,}/g,`
`),r}const pe=async()=>{var r,o,X,Y,$,q,Q,Z,J,ee,te,ne;const e=c+"/KioskServiceDetail/get-service-detail-by-id/"+m,t=await v(e);re(t);const a=Ie+l+"/"+((X=(o=(r=t==null?void 0:t.blobLink)==null?void 0:r.split("/"))==null?void 0:o.pop())==null?void 0:X.toString());if(oe(a),D(t==null?void 0:t.htmlTranscript),T(t==null?void 0:t.companyId),L(t==null?void 0:t.serviceId),_(t==null?void 0:t.title),R(t==null?void 0:t.timeForService),W(t==null?void 0:t.chargeForService),H(t==null?void 0:t.branchId),O(t==null?void 0:t.isActive),t!=null&&t.imageLink){const p=(q=($=(Y=t==null?void 0:t.imageLink)==null?void 0:Y.split("/"))==null?void 0:$.pop())==null?void 0:q.toString(),u=b+l+"/"+p;j(u)}else if(t!=null&&t.docLink){const p=(J=(Z=(Q=t==null?void 0:t.docLink)==null?void 0:Q.split("/"))==null?void 0:Z.pop())==null?void 0:J.toString(),u=b+l+"/"+p;j(u)}else{const p=(ne=(te=(ee=t==null?void 0:t.blobLink)==null?void 0:ee.split("/"))==null?void 0:te.pop())==null?void 0:ne.toString(),u=b+l+"/"+p;j(u)}},ue=async()=>{const e=c+"/KioskService/get-all-company-department/"+l,t=await v(e);le(t)},K="use-uuid-if-multiple-on-page";s.useEffect(()=>{const e=document.querySelector(`#${K}`);e&&e.load()}),s.useEffect(()=>{ue(),pe()},[m,N,l]);const he=async()=>{const e=c+"/Company/get-companies/",t=await v(e);ce(t),T(l),ge(l)},ge=async e=>{const t=c+"/Branch/get-all-branches-for-company/"+e;let a=await v(t);de(a)};s.useEffect(()=>{he()},[]);const z={PaperProps:{style:{maxHeight:48*4.5+8,width:250}}},ve=async()=>{let e=new FormData;if(e.append("id",m),e.append("title",M),e.append("companyID",G),e.append("serviceId",w),e.append("timeForService",P),e.append("chargeForService",U),e.append("branchId",B),e.append("isActive",A),!(i!=null&&i.isTTSContent)){const r=c+"/KioskServiceDetail/save-service-detail";await ie(r,e),g(-1);return}let t=me(f);e.append("transcript",t),e.append("HTMLTranscript",f),e.append("supportingFile",ae);const a=c+"/KioskServiceDetail/save-tts-service-detail";await ie(a,e),g(-1)},xe=async()=>{var e=confirm("are you sure you want to permanently delete this record");if(!e)return;const t=c+"/KioskServiceDetail/delete-service-detail/"+m;await se(t,{}),g(-1)},[fe,V]=s.useState(!1),je=async()=>{const e=c+"/KioskServiceDetail/convert-tts-service-detail/"+m;var t=confirm("are you sure you want to use this service");t&&(V(!0),await se(e,{}),V(!1),g(-1))},ye=e=>{O(e.target.checked)};return n.jsxs(Ce,{title:"Editing Service Detail",children:[n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Title"}),n.jsx(h,{id:"outlined-basic",value:M,onChange:e=>{var t;_((t=e==null?void 0:e.target)==null?void 0:t.value)},variant:"outlined",autoComplete:"off",fullWidth:!0})]}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Is Active? "}),n.jsx(Ne,{checked:A,onChange:ye,inputProps:{"aria-label":"controlled"}})]}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Is Text To Speech Content:Â  "}),(i==null?void 0:i.isTTSContent)&&n.jsx("span",{style:{fontWeight:"bold",color:"green"},children:"Yes"}),!(i!=null&&i.isTTSContent)&&n.jsx("span",{style:{fontWeight:"bold",color:"red"},children:"No"})]}),(i==null?void 0:i.isTTSContent)&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginTop:"0.9rem"},children:n.jsx("span",{children:"Transcript"})}),n.jsx(Fe,{value:f,onChange:D})]}),i!=null&&i.isTTSContent?n.jsx(n.Fragment,{children:n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{style:{marginRight:"1rem"},children:"Chosen Supporting File"}),n.jsx("span",{style:{width:"2rem"},children:"      "}),n.jsx("a",{href:k,target:"_blank",children:"Uploaded File"}),n.jsx(h,{id:"outlined-basic",inputProps:{accept:".docx,.doc,.pdf"},variant:"outlined",type:"file",autoComplete:"off",fullWidth:!0,onChange:e=>{var t;return E((t=e==null?void 0:e.target)==null?void 0:t.files[0])}})]})}):n.jsx(n.Fragment,{children:n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{style:{marginRight:"1rem"},children:"Chosen File"}),n.jsx("span",{style:{width:"2rem"},children:"      "}),n.jsx("a",{href:k,target:"_blank",children:"Uploaded File"}),n.jsx(h,{id:"outlined-basic",variant:"outlined",type:"file",autoComplete:"off",fullWidth:!0,onChange:e=>{var t;return E((t=e==null?void 0:e.target)==null?void 0:t.files[0])}})]})}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Time For Service"}),n.jsx(h,{variant:"outlined",multiline:!0,value:P,onChange:e=>{var t;R((t=e==null?void 0:e.target)==null?void 0:t.value)},fullWidth:!0})]}),n.jsxs("div",{style:{marginTop:"0.9rem"},children:[n.jsx("span",{children:"Charge For Service"}),n.jsx(h,{variant:"outlined",multiline:!0,value:U,onChange:e=>{var t;W((t=e==null?void 0:e.target)==null?void 0:t.value)},fullWidth:!0})]}),(i==null?void 0:i.isTTSContent)&&n.jsxs(n.Fragment,{children:[n.jsx(be,{variant:"body1",style:{marginTop:"0.9rem"},children:"Generated Speech :"}),n.jsxs("audio",{id:K,controls:!0,children:[n.jsx("source",{src:N,type:"audio/mpeg"}),"Your browser does not support the audio element."]},123)]}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:0,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Company"}),n.jsxs(I,{disabled:!0,labelId:"demo-select-small-label",id:"demo-select-small",value:Number(G),width:"300px",placeholder:"Choose your Company",MenuProps:z,onChange:e=>{var t;T(Number((t=e==null?void 0:e.target)==null?void 0:t.value))},children:[n.jsx(d,{value:"",children:n.jsx("em",{children:"None"})}),y==null?void 0:y.map(e=>n.jsx(d,{value:e==null?void 0:e.id,children:e==null?void 0:e.name},e==null?void 0:e.id))]})]})})}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:0,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Service Branch"}),n.jsxs(I,{labelId:"demo-select-small-label",id:"demo-select-small",value:Number(B),width:"300px",placeholder:"Choose your Company",MenuProps:z,onChange:e=>{var t;return H((t=e==null?void 0:e.target)==null?void 0:t.value)},children:[n.jsx(d,{value:"",children:n.jsx("em",{children:"None"})}),S==null?void 0:S.map(e=>n.jsx(d,{value:e==null?void 0:e.id,children:e==null?void 0:e.title},e==null?void 0:e.id))]})]})})}),n.jsx("div",{style:{marginTop:"0rem"},children:n.jsx(C,{sx:{m:1,minWidth:120},size:"small",children:n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("p",{style:{marginRight:"2rem"},children:"Service Department"}),n.jsxs(I,{labelId:"demo-select-small-label",id:"demo-select-small",value:Number(w),width:"300px",onChange:e=>{var t;L((t=e==null?void 0:e.target)==null?void 0:t.value)},children:[n.jsx(d,{value:"",children:n.jsx("em",{children:"None"})}),x==null?void 0:x.map(e=>n.jsx(d,{value:e==null?void 0:e.id,children:e==null?void 0:e.departmentName},e==null?void 0:e.id))]})]})})}),fe?n.jsx("div",{children:n.jsx("p",{style:{color:"gray",fontWeight:"bold",fontSize:"1.1rem"},children:"Converting Text To Speech ...."})}):n.jsxs("div",{style:{marginTop:"1.2rem"},children:[n.jsx(F,{variant:"contained",onClick:()=>ve(),children:"Save Changes"}),(i==null?void 0:i.isTTSContent)&&n.jsx(F,{color:"info",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>je(),children:"Convert TTS"}),n.jsx(F,{color:"error",style:{marginLeft:"2rem"},variant:"contained",onClick:()=>{xe()},children:"Delete"})]})]})};export{Ae as default};
